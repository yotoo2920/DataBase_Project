--Selects the average salary in the us

SELECT  TRUNC(AVG(WEEKLY_SALARY)*12, 2) AS AVERAGE_SALARY
FROM PERSON;

--Selects the Occupation and yearly salary of the Occupation with the largest salary

SELECT OCCUPATION, TRUNC(AVG(WEEKLY_SALARY)*12, 2) AS AVERAGE_SALARY FROM PERSON
WHERE WEEKLY_SALARY = (SELECT MAX(WEEKLY_SALARY) FROM PERSON) AND ROWNUM = 1
GROUP BY OCCUPATION; 

--Selects the state name and salary from the state with the highest salary

SELECT STATE.NAME, TRUNC(AVG(WEEKLY_SALARY)*12, 2) AS AVERAGE_SALARY  
FROM STATE JOIN PERSON ON STATE.ABBREVIATION = PERSON.REGION 
WHERE WEEKLY_SALARY = (SELECT MAX(WEEKLY_SALARY) FROM PERSON) AND ROWNUM = 1
GROUP BY STATE.NAME;

--Selects the Name of the state and the WPC(wealth per citizen)
--defined as the GDP of state/Population
--of the state with the highest wealth per citizen 

SELECT * FROM(
  SELECT NAME, GDP/POPULATION AS WEALTH_PER_CITIZEN
  FROM(
    SELECT STATE.NAME AS NAME, COUNT(PERSON.NAME) AS POPULATION, SUM(PERSON.WEEKLY_SALARY)*12 AS GDP
    FROM PERSON JOIN STATE ON STATE.ABBREVIATION = PERSON.REGION
    GROUP BY STATE.NAME
  )
  ORDER BY WEALTH_PER_CITIZEN DESC
  )
WHERE ROWNUM = 1;

--Find the company name and the average salary of the company with the Highest average salary

SELECT COMPANY, AVG_WEEKLY_SAL*12 AS AVG_SALARY FROM(
  SELECT ORGANIZATION.NAME AS COMPANY, AVG(PERSON.WEEKLY_SALARY) AS AVG_WEEKLY_SAL
  FROM ORGANIZATION JOIN JOBS ON ORGANIZATION.NAME = JOBS.COMPANY_NAME
  JOIN PERSON ON JOBS.NAME = PERSON.OCCUPATION
  GROUP BY ORGANIZATION.NAME
  ORDER BY AVG_WEEKLY_SAL DESC
  )
WHERE ROWNUM = 1;